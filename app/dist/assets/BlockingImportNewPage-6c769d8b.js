import{c as v,_ as y,b as A,n as U,o as q,r as w,u as V,a as Z,j as a,p as z,f as Y}from"./index-2dbb1652.js";import{r as H,i as W}from"./createSvgIcon-a0ec418b.js";import{a as X,d as K}from"./Close-e2dcb80d.js";import{g as J,E as k,c as Q,a as tt}from"./styled-4db7b868.js";import{T as et,F as rt,a as at}from"./TextField-08f9fe99.js";import{I as P}from"./InputAdornment-dc5b167b.js";import{g as ot,T as D}from"./Typography-94b0b471.js";import{I as E}from"./Menu-c2f3532a.js";import{S as it,d as st,F as nt}from"./ArrowBack-3531cade.js";import{u as lt}from"./common-58346add.js";import{a as ct}from"./api-ff746449.js";import{C as dt}from"./Container-84fa18ed.js";import{T as ut}from"./Toolbar-cb95e5db.js";import{B as pt}from"./Box-2b2c394b.js";import{L as mt,C as ht}from"./LoadingButton-8732500b.js";import{C as ft,a as gt}from"./CardContent-d317f198.js";import{A as R}from"./Alert-7e485670.js";import{G as N}from"./Grid-8e00a65e.js";import{B as bt}from"./Backdrop-6c8621f1.js";import{P as xt}from"./Page-d6c42c0d.js";import"./Select-491dbed8.js";function vt(t){return J("MuiSwitch",t)}const yt=ot("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),l=yt,wt=["className","color","edge","size","sx"],kt=t=>{const{classes:e,edge:r,size:o,color:s,checked:i,disabled:c}=t,u={root:["root",r&&`edge${v(r)}`,`size${v(o)}`],switchBase:["switchBase",`color${v(s)}`,i&&"checked",c&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},n=tt(u,vt,e);return y({},e,n)},jt=k("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.edge&&e[`edge${v(r.edge)}`],e[`size${v(r.size)}`]]}})(({ownerState:t})=>y({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"}},t.edge==="start"&&{marginLeft:-8},t.edge==="end"&&{marginRight:-8},t.size==="small"&&{width:40,height:24,padding:7,[`& .${l.thumb}`]:{width:16,height:16},[`& .${l.switchBase}`]:{padding:4,[`&.${l.checked}`]:{transform:"translateX(16px)"}}})),Ct=k(it,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.switchBase,{[`& .${l.input}`]:e.input},r.color!=="default"&&e[`color${v(r.color)}`]]}})(({theme:t})=>({position:"absolute",top:0,left:0,zIndex:1,color:t.vars?t.vars.palette.Switch.defaultColor:`${t.palette.mode==="light"?t.palette.common.white:t.palette.grey[300]}`,transition:t.transitions.create(["left","transform"],{duration:t.transitions.duration.shortest}),[`&.${l.checked}`]:{transform:"translateX(20px)"},[`&.${l.disabled}`]:{color:t.vars?t.vars.palette.Switch.defaultDisabledColor:`${t.palette.mode==="light"?t.palette.grey[100]:t.palette.grey[600]}`},[`&.${l.checked} + .${l.track}`]:{opacity:.5},[`&.${l.disabled} + .${l.track}`]:{opacity:t.vars?t.vars.opacity.switchTrackDisabled:`${t.palette.mode==="light"?.12:.2}`},[`& .${l.input}`]:{left:"-100%",width:"300%"}}),({theme:t,ownerState:e})=>y({"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:A(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},e.color!=="default"&&{[`&.${l.checked}`]:{color:(t.vars||t).palette[e.color].main,"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:A(t.palette[e.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${l.disabled}`]:{color:t.vars?t.vars.palette.Switch[`${e.color}DisabledColor`]:`${t.palette.mode==="light"?U(t.palette[e.color].main,.62):q(t.palette[e.color].main,.55)}`}},[`&.${l.checked} + .${l.track}`]:{backgroundColor:(t.vars||t).palette[e.color].main}})),St=k("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(t,e)=>e.track})(({theme:t})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:t.transitions.create(["opacity","background-color"],{duration:t.transitions.duration.shortest}),backgroundColor:t.vars?t.vars.palette.common.onBackground:`${t.palette.mode==="light"?t.palette.common.black:t.palette.common.white}`,opacity:t.vars?t.vars.opacity.switchTrack:`${t.palette.mode==="light"?.38:.3}`})),$t=k("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(t,e)=>e.thumb})(({theme:t})=>({boxShadow:(t.vars||t).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"})),Bt=w.forwardRef(function(e,r){const o=V({props:e,name:"MuiSwitch"}),{className:s,color:i="primary",edge:c=!1,size:u="medium",sx:n}=o,d=Z(o,wt),h=y({},o,{color:i,edge:c,size:u}),g=kt(h),x=a.jsx($t,{className:g.thumb,ownerState:h});return a.jsxs(jt,{className:Q(g.root,s),sx:n,ownerState:h,children:[a.jsx(Ct,y({type:"checkbox",icon:x,checkedIcon:x,ref:r,ownerState:h},d,{classes:y({},g,{root:g.switchBase})})),a.jsx(St,{className:g.track,ownerState:h})]})}),It=Bt;var F={},zt=W;Object.defineProperty(F,"__esModule",{value:!0});var G=F.default=void 0,Ft=zt(H()),Tt=a,Mt=(0,Ft.default)((0,Tt.jsx)("path",{d:"M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z"}),"AttachFile");G=F.default=Mt;const At=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],Pt=["B","kiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],Rt=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],Nt=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],_=(t,e,r)=>{let o=t;return typeof e=="string"||Array.isArray(e)?o=t.toLocaleString(e,r):(e===!0||r!==void 0)&&(o=t.toLocaleString(void 0,r)),o};function L(t,e){if(!Number.isFinite(t))throw new TypeError(`Expected a finite number, got ${typeof t}: ${t}`);e={bits:!1,binary:!1,...e};const r=e.bits?e.binary?Nt:Rt:e.binary?Pt:At;if(e.signed&&t===0)return` 0 ${r[0]}`;const o=t<0,s=o?"-":e.signed?"+":"";o&&(t=-t);let i;if(e.minimumFractionDigits!==void 0&&(i={minimumFractionDigits:e.minimumFractionDigits}),e.maximumFractionDigits!==void 0&&(i={maximumFractionDigits:e.maximumFractionDigits,...i}),t<1){const d=_(t,e.locale,i);return s+d+" "+r[0]}const c=Math.min(Math.floor(e.binary?Math.log(t)/Math.log(1024):Math.log10(t)/3),r.length-1);t/=(e.binary?1024:1e3)**c,i||(t=t.toPrecision(3));const u=_(Number(t),e.locale,i),n=r[c];return s+u+" "+n}const _t=k("label")`
  position: relative;

  input {
    opacity: 0 !important;
  }

  span {
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    z-index: 2;
    display: flex;
    align-items: center;
  }

  span.MuiFileInput-placeholder {
    color: gray;
  }
`,Lt={Label:_t},Dt=z.forwardRef((t,e)=>{const{text:r,isPlaceholder:o,placeholder:s,...i}=t,c=z.useId();return a.jsxs(Lt.Label,{htmlFor:c,children:[a.jsx("input",{...i,ref:e,id:c}),r?a.jsx("span",{"aria-placeholder":s,className:o?"MuiFileInput-placeholder":"",children:r}):null]})});function Et(t){return t.length>0}function Gt(t){return t.reduce((e,r)=>e+r.size,0)}function I(t){return typeof window<"u"&&t instanceof File}function Ot(t){return Array.from(t)}function Ut(t,e){if(t.length<e)return t;const r=Math.floor((e-1)/2);return`${t.slice(0,r)}…${t.slice(t.length-r)}`}function qt(t){var T;const{value:e,onChange:r,disabled:o,getInputText:s,getSizeText:i,placeholder:c,hideSizeText:u,inputProps:n,InputProps:d,multiple:h,className:g,...x}=t,j=z.useRef(null),C=h||(n==null?void 0:n.multiple)||((T=d==null?void 0:d.inputProps)==null?void 0:T.multiple)||!1,S=()=>{const m=j.current;m&&(m.value="")},p=m=>{const $=m.target.files,M=$?Ot($):[];S(),r==null||r(C?M:M[0])},B=m=>{m.preventDefault(),!o&&(r==null||r(h?[]:null))},b=Array.isArray(e)?Et(e):I(e),f=()=>{var m;if(e===null||Array.isArray(e)&&e.length===0)return c||"";if(typeof s=="function"&&e!==void 0)return s(e);if(e&&b){if(Array.isArray(e)&&e.length>1)return`${e.length} files`;const $=I(e)?e.name:((m=e[0])==null?void 0:m.name)||"";return Ut($,20)}return""},O=()=>{if(typeof i=="function"&&e!==void 0)return i(e);if(b){if(Array.isArray(e)){const m=Gt(e);return L(m)}if(I(e))return L(e.size)}return""};return a.jsx(et,{type:"file",disabled:o,onChange:p,className:`MuiFileInput-TextField ${g||""}`,InputProps:{startAdornment:a.jsx(P,{position:"start",children:a.jsx(G,{})}),endAdornment:a.jsxs(P,{position:"end",style:{visibility:b?"visible":"hidden"},children:[u?null:a.jsx(D,{variant:"caption",mr:"2px",className:"MuiFileInput-Typography-size-text",children:O()}),a.jsx(E,{"aria-label":"Clear",title:"Clear",size:"small",disabled:o,className:"MuiFileInput-IconButton",onClick:B,children:a.jsx(X,{fontSize:"small"})})]}),...d,inputProps:{text:f(),multiple:C,isPlaceholder:e===null||Array.isArray(e)&&e.length===0,ref:j,placeholder:c,...n,...d==null?void 0:d.inputProps},inputComponent:Dt},...x})}function Vt(){const t=Y(),e=lt(p=>p.showSnackbar),[r,o]=w.useState([]),[s,i]=w.useState(!0),[c,u]=w.useState(!1),[n,d]=w.useState(!1),h=p=>{u(!1),o(p)},g=p=>{u(!1),i(p.target.checked)},x=()=>{(r==null?void 0:r.length)>0&&j(r)},j=p=>{d(!0),u(!1);const B=new URL(`${ct}/blocking/import`),b=new FormData;b.append("truncate",String(s));for(const f of p)b.append("files",f,f.name);fetch(B,{method:"POST",body:b}).then(f=>{if(!f.ok){u(!0);return}return f.json()}).then(f=>{S(f.id),e("La importación se completó correctamente","success")}).catch(f=>u(!0)).finally(()=>d(!1))},C=()=>{S()},S=p=>{t({pathname:"/tool/blocking/imports",search:`?selected=${p}`})};return a.jsxs(dt,{sx:{mt:4,mb:4},children:[a.jsxs(ut,{disableGutters:!0,children:[a.jsx(E,{size:"large",color:"inherit",sx:{mr:2},onClick:C,children:a.jsx(st,{})}),a.jsx(D,{component:"h1",variant:"h6",noWrap:!0,sx:{flexGrow:1},children:"Nueva importación"}),a.jsx(pt,{sx:{display:"flex",gap:2},children:a.jsx(mt,{loading:n,variant:"contained",size:"small",disableElevation:!0,startIcon:a.jsx(K,{}),onClick:x,children:"Importar"})})]}),a.jsx(ft,{variant:"outlined",children:a.jsxs(gt,{children:[c&&a.jsx(R,{severity:"error",sx:{marginBottom:1},children:"La importación falló. Intentelo nuevamente."}),a.jsx(N,{container:!0,spacing:3,children:a.jsx(N,{item:!0,xs:12,md:6,children:a.jsx(qt,{label:"Archivos (.csv)",size:"small",margin:"normal",multiple:!0,value:r,onChange:h,inputProps:{accept:".csv"},disabled:n})})}),a.jsxs(rt,{sx:{m:1.5},variant:"standard",children:[a.jsx(at,{children:"Restablecer tablas"}),a.jsx(nt,{control:a.jsx(It,{color:"secondary",checked:s,onChange:g,disabled:n}),label:"Habilitar"})]}),!s&&a.jsx(R,{severity:"warning",children:"Si inhabilitas el restablecer tablas, podrías causar que la importación falle cuando encuentre que un deviceId fue previamente importado."})]})}),a.jsx(bt,{sx:{color:"#fff",zIndex:p=>p.zIndex.drawer+1},open:n,children:a.jsx(ht,{color:"inherit"})})]})}function me(){return a.jsx(xt,{title:"Importar archivos",children:a.jsx(Vt,{})})}export{me as default};
