import{c as x,_ as y,b as A,n as U,o as q,r as w,u as V,a as Z,j as a,p as F,f as Y}from"./index-2f39f1ff.js";import{r as H,i as W}from"./createSvgIcon-fe8ff9c0.js";import{a as X,d as K}from"./Close-0df80e51.js";import{g as J,E as k,c as Q,a as tt}from"./styled-ba155756.js";import{T as et,F as rt,a as at}from"./TextField-0ee35791.js";import{I as P}from"./InputAdornment-d04ce659.js";import{g as ot,T as D}from"./Typography-0d07a002.js";import{I as E}from"./Menu-1e9c4500.js";import{S as it,d as st,F as nt}from"./ArrowBack-40484030.js";import{u as lt}from"./common-2edd7306.js";import{a as ct}from"./api-ff746449.js";import{C as dt}from"./Container-542a9efe.js";import{T as ut}from"./Toolbar-89cd294d.js";import{B as pt}from"./Box-69448d45.js";import{L as mt}from"./LoadingButton-4d47bd0e.js";import{C as ht,a as ft}from"./CardContent-e1b514cb.js";import{A as R}from"./Alert-4a13142a.js";import{G as N}from"./Grid-a3a02809.js";import{P as gt}from"./Page-6a23b43c.js";import"./Select-c4a912be.js";import"./useSlotProps-e4148f9c.js";function bt(t){return J("MuiSwitch",t)}const vt=ot("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),n=vt,xt=["className","color","edge","size","sx"],yt=t=>{const{classes:e,edge:r,size:o,color:s,checked:i,disabled:l}=t,u={root:["root",r&&`edge${x(r)}`,`size${x(o)}`],switchBase:["switchBase",`color${x(s)}`,i&&"checked",l&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},c=tt(u,bt,e);return y({},e,c)},wt=k("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.edge&&e[`edge${x(r.edge)}`],e[`size${x(r.size)}`]]}})(({ownerState:t})=>y({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"}},t.edge==="start"&&{marginLeft:-8},t.edge==="end"&&{marginRight:-8},t.size==="small"&&{width:40,height:24,padding:7,[`& .${n.thumb}`]:{width:16,height:16},[`& .${n.switchBase}`]:{padding:4,[`&.${n.checked}`]:{transform:"translateX(16px)"}}})),kt=k(it,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.switchBase,{[`& .${n.input}`]:e.input},r.color!=="default"&&e[`color${x(r.color)}`]]}})(({theme:t})=>({position:"absolute",top:0,left:0,zIndex:1,color:t.vars?t.vars.palette.Switch.defaultColor:`${t.palette.mode==="light"?t.palette.common.white:t.palette.grey[300]}`,transition:t.transitions.create(["left","transform"],{duration:t.transitions.duration.shortest}),[`&.${n.checked}`]:{transform:"translateX(20px)"},[`&.${n.disabled}`]:{color:t.vars?t.vars.palette.Switch.defaultDisabledColor:`${t.palette.mode==="light"?t.palette.grey[100]:t.palette.grey[600]}`},[`&.${n.checked} + .${n.track}`]:{opacity:.5},[`&.${n.disabled} + .${n.track}`]:{opacity:t.vars?t.vars.opacity.switchTrackDisabled:`${t.palette.mode==="light"?.12:.2}`},[`& .${n.input}`]:{left:"-100%",width:"300%"}}),({theme:t,ownerState:e})=>y({"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:A(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},e.color!=="default"&&{[`&.${n.checked}`]:{color:(t.vars||t).palette[e.color].main,"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:A(t.palette[e.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${n.disabled}`]:{color:t.vars?t.vars.palette.Switch[`${e.color}DisabledColor`]:`${t.palette.mode==="light"?U(t.palette[e.color].main,.62):q(t.palette[e.color].main,.55)}`}},[`&.${n.checked} + .${n.track}`]:{backgroundColor:(t.vars||t).palette[e.color].main}})),St=k("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(t,e)=>e.track})(({theme:t})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:t.transitions.create(["opacity","background-color"],{duration:t.transitions.duration.shortest}),backgroundColor:t.vars?t.vars.palette.common.onBackground:`${t.palette.mode==="light"?t.palette.common.black:t.palette.common.white}`,opacity:t.vars?t.vars.opacity.switchTrack:`${t.palette.mode==="light"?.38:.3}`})),$t=k("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(t,e)=>e.thumb})(({theme:t})=>({boxShadow:(t.vars||t).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"})),jt=w.forwardRef(function(e,r){const o=V({props:e,name:"MuiSwitch"}),{className:s,color:i="primary",edge:l=!1,size:u="medium",sx:c}=o,d=Z(o,xt),h=y({},o,{color:i,edge:l,size:u}),g=yt(h),v=a.jsx($t,{className:g.thumb,ownerState:h});return a.jsxs(wt,{className:Q(g.root,s),sx:c,ownerState:h,children:[a.jsx(kt,y({type:"checkbox",icon:v,checkedIcon:v,ref:r,ownerState:h},d,{classes:y({},g,{root:g.switchBase})})),a.jsx(St,{className:g.track,ownerState:h})]})}),Ct=jt;var z={},Bt=W;Object.defineProperty(z,"__esModule",{value:!0});var G=z.default=void 0,It=Bt(H()),Ft=a,zt=(0,It.default)((0,Ft.jsx)("path",{d:"M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z"}),"AttachFile");G=z.default=zt;const Tt=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],Mt=["B","kiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],At=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],Pt=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],_=(t,e,r)=>{let o=t;return typeof e=="string"||Array.isArray(e)?o=t.toLocaleString(e,r):(e===!0||r!==void 0)&&(o=t.toLocaleString(void 0,r)),o};function L(t,e){if(!Number.isFinite(t))throw new TypeError(`Expected a finite number, got ${typeof t}: ${t}`);e={bits:!1,binary:!1,...e};const r=e.bits?e.binary?Pt:At:e.binary?Mt:Tt;if(e.signed&&t===0)return` 0 ${r[0]}`;const o=t<0,s=o?"-":e.signed?"+":"";o&&(t=-t);let i;if(e.minimumFractionDigits!==void 0&&(i={minimumFractionDigits:e.minimumFractionDigits}),e.maximumFractionDigits!==void 0&&(i={maximumFractionDigits:e.maximumFractionDigits,...i}),t<1){const d=_(t,e.locale,i);return s+d+" "+r[0]}const l=Math.min(Math.floor(e.binary?Math.log(t)/Math.log(1024):Math.log10(t)/3),r.length-1);t/=(e.binary?1024:1e3)**l,i||(t=t.toPrecision(3));const u=_(Number(t),e.locale,i),c=r[l];return s+u+" "+c}const Rt=k("label")`
  position: relative;

  input {
    opacity: 0 !important;
  }

  span {
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    z-index: 2;
    display: flex;
    align-items: center;
  }

  span.MuiFileInput-placeholder {
    color: gray;
  }
`,Nt={Label:Rt},_t=F.forwardRef((t,e)=>{const{text:r,isPlaceholder:o,placeholder:s,...i}=t,l=F.useId();return a.jsxs(Nt.Label,{htmlFor:l,children:[a.jsx("input",{...i,ref:e,id:l}),r?a.jsx("span",{"aria-placeholder":s,className:o?"MuiFileInput-placeholder":"",children:r}):null]})});function Lt(t){return t.length>0}function Dt(t){return t.reduce((e,r)=>e+r.size,0)}function I(t){return typeof window<"u"&&t instanceof File}function Et(t){return Array.from(t)}function Gt(t,e){if(t.length<e)return t;const r=Math.floor((e-1)/2);return`${t.slice(0,r)}…${t.slice(t.length-r)}`}function Ot(t){var T;const{value:e,onChange:r,disabled:o,getInputText:s,getSizeText:i,placeholder:l,hideSizeText:u,inputProps:c,InputProps:d,multiple:h,className:g,...v}=t,S=F.useRef(null),$=h||(c==null?void 0:c.multiple)||((T=d==null?void 0:d.inputProps)==null?void 0:T.multiple)||!1,j=()=>{const m=S.current;m&&(m.value="")},p=m=>{const C=m.target.files,M=C?Et(C):[];j(),r==null||r($?M:M[0])},B=m=>{m.preventDefault(),!o&&(r==null||r(h?[]:null))},b=Array.isArray(e)?Lt(e):I(e),f=()=>{var m;if(e===null||Array.isArray(e)&&e.length===0)return l||"";if(typeof s=="function"&&e!==void 0)return s(e);if(e&&b){if(Array.isArray(e)&&e.length>1)return`${e.length} files`;const C=I(e)?e.name:((m=e[0])==null?void 0:m.name)||"";return Gt(C,20)}return""},O=()=>{if(typeof i=="function"&&e!==void 0)return i(e);if(b){if(Array.isArray(e)){const m=Dt(e);return L(m)}if(I(e))return L(e.size)}return""};return a.jsx(et,{type:"file",disabled:o,onChange:p,className:`MuiFileInput-TextField ${g||""}`,InputProps:{startAdornment:a.jsx(P,{position:"start",children:a.jsx(G,{})}),endAdornment:a.jsxs(P,{position:"end",style:{visibility:b?"visible":"hidden"},children:[u?null:a.jsx(D,{variant:"caption",mr:"2px",className:"MuiFileInput-Typography-size-text",children:O()}),a.jsx(E,{"aria-label":"Clear",title:"Clear",size:"small",disabled:o,className:"MuiFileInput-IconButton",onClick:B,children:a.jsx(X,{fontSize:"small"})})]}),...d,inputProps:{text:f(),multiple:$,isPlaceholder:e===null||Array.isArray(e)&&e.length===0,ref:S,placeholder:l,...c,...d==null?void 0:d.inputProps},inputComponent:_t},...v})}function Ut(){const t=Y(),e=lt(p=>p.showSnackbar),[r,o]=w.useState([]),[s,i]=w.useState(!0),[l,u]=w.useState(!1),[c,d]=w.useState(!1),h=p=>{u(!1),o(p)},g=p=>{u(!1),i(p.target.checked)},v=()=>{(r==null?void 0:r.length)>0&&S(r)},S=p=>{d(!0),u(!1);const B=new URL(`${ct}/blocking/import`),b=new FormData;b.append("truncate",String(s));for(const f of p)b.append("files",f,f.name);fetch(B,{method:"POST",body:b}).then(f=>{if(!f.ok){u(!0);return}return f.json()}).then(f=>{j(f.id),e("La importación se completó correctamente","success")}).catch(f=>u(!0)).finally(()=>d(!1))},$=()=>{j()},j=p=>{t({pathname:"/tool/blocking/imports",search:`?selected=${p}`})};return a.jsxs(dt,{sx:{mt:4,mb:4},children:[a.jsxs(ut,{disableGutters:!0,children:[a.jsx(E,{size:"large",color:"inherit",sx:{mr:2},onClick:$,children:a.jsx(st,{})}),a.jsx(D,{component:"h1",variant:"h6",noWrap:!0,sx:{flexGrow:1},children:"Nueva importación"}),a.jsx(pt,{sx:{display:"flex",gap:2},children:a.jsx(mt,{loading:c,variant:"contained",size:"small",disableElevation:!0,startIcon:a.jsx(K,{}),onClick:v,children:"Importar"})})]}),a.jsx(ht,{variant:"outlined",children:a.jsxs(ft,{children:[l&&a.jsx(R,{severity:"error",sx:{marginBottom:1},children:"La importación falló. Intentelo nuevamente."}),a.jsx(N,{container:!0,spacing:3,children:a.jsx(N,{item:!0,xs:12,md:6,children:a.jsx(Ot,{label:"Archivos (.csv)",size:"small",margin:"normal",multiple:!0,value:r,onChange:h,inputProps:{accept:".csv"},disabled:c})})}),a.jsxs(rt,{sx:{m:1.5},variant:"standard",children:[a.jsx(at,{children:"Restablecer tablas"}),a.jsx(nt,{control:a.jsx(Ct,{color:"secondary",checked:s,onChange:g,disabled:c}),label:"Habilitar"})]}),!s&&a.jsx(R,{severity:"warning",children:"Si inhabilitas el restablecer tablas, podrías causar que la importación falle cuando encuentre que un deviceId fue previamente importado."})]})})]})}function ue(){return a.jsx(gt,{title:"Importar archivos",children:a.jsx(Ut,{})})}export{ue as default};
