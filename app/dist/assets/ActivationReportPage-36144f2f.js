import{r as h,u as he,a as ve,_ as G,j as e,i as fe}from"./index-c55a0fba.js";import{r as m,i as g}from"./createSvgIcon-bd1704b2.js";import{a as _}from"./api-ff746449.js";import{u as xe}from"./common-7636977c.js";import{C as me}from"./Container-32e80ff4.js";import{g as ge,P as je,T as be}from"./Typography-68b384b6.js";import{T as _e,a as Re,b as R,c as C}from"./TabPanel-3bbdc03e.js";import{B as Q}from"./Box-c2177a00.js";import{T as Ce}from"./Toolbar-d0ba1ecd.js";import{L as P}from"./LoadingButton-a5da5fcf.js";import{f as ye,L as Te,T as Pe,a as $e,b as Se,c as y,d as o,e as Le}from"./TableRow-0a511df5.js";import{S as ke}from"./Stack-ef93bac3.js";import{g as De,E as Me,c as Oe,a as Ae}from"./styled-82db80f4.js";import{P as Ie}from"./Page-32cf40c3.js";import"./useSlotProps-46c78ac0.js";import"./KeyboardArrowRight-d32c6298.js";function ze(a){return De("MuiTableFooter",a)}ge("MuiTableFooter",["root"]);const Ue=["className","component"],Be=a=>{const{classes:l}=a;return Ae({root:["root"]},ze,l)},He=Me("tfoot",{name:"MuiTableFooter",slot:"Root",overridesResolver:(a,l)=>l.root})({display:"table-footer-group"}),We={variant:"footer"},J="tfoot",we=h.forwardRef(function(l,i){const n=he({props:l,name:"MuiTableFooter"}),{className:v,component:c=J}=n,u=ve(n,Ue),j=G({},n,{component:c}),b=Be(j);return e.jsx(ye.Provider,{value:We,children:e.jsx(He,G({as:c,className:Oe(b.root,v),ref:i,role:c===J?null:"rowgroup",ownerState:j},u))})}),Fe=we;var S={},qe=g;Object.defineProperty(S,"__esModule",{value:!0});var K=S.default=void 0,Ee=qe(m()),Ne=e,Ve=(0,Ee.default)((0,Ne.jsx)("path",{d:"m22.7 19-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4z"}),"Build");K=S.default=Ve;var L={},Ge=g;Object.defineProperty(L,"__esModule",{value:!0});var $=L.default=void 0,Qe=Ge(m()),Je=e,Ke=(0,Qe.default)((0,Je.jsx)("path",{d:"M5 20h14v-2H5v2zM19 9h-4V3H9v6H5l7 7 7-7z"}),"Download");$=L.default=Ke;var k={},Xe=g;Object.defineProperty(k,"__esModule",{value:!0});var X=k.default=void 0,Ye=Xe(m()),Ze=e,et=(0,Ye.default)((0,Ze.jsx)("path",{d:"m17.6 9.48 1.84-3.18c.16-.31.04-.69-.26-.85-.29-.15-.65-.06-.83.22l-1.88 3.24c-2.86-1.21-6.08-1.21-8.94 0L5.65 5.67c-.19-.29-.58-.38-.87-.2-.28.18-.37.54-.22.83L6.4 9.48C3.3 11.25 1.28 14.44 1 18h22c-.28-3.56-2.3-6.75-5.4-8.52zM7 15.25c-.69 0-1.25-.56-1.25-1.25s.56-1.25 1.25-1.25 1.25.56 1.25 1.25-.56 1.25-1.25 1.25zm10 0c-.69 0-1.25-.56-1.25-1.25s.56-1.25 1.25-1.25 1.25.56 1.25 1.25-.56 1.25-1.25 1.25z"}),"Android");X=k.default=et;var D={},tt=g;Object.defineProperty(D,"__esModule",{value:!0});var Y=D.default=void 0;ot(h);var at=tt(m()),rt=e;function Z(a){if(typeof WeakMap!="function")return null;var l=new WeakMap,i=new WeakMap;return(Z=function(n){return n?i:l})(a)}function ot(a,l){if(!l&&a&&a.__esModule)return a;if(a===null||typeof a!="object"&&typeof a!="function")return{default:a};var i=Z(l);if(i&&i.has(a))return i.get(a);var n={},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in a)if(c!=="default"&&Object.prototype.hasOwnProperty.call(a,c)){var u=v?Object.getOwnPropertyDescriptor(a,c):null;u&&(u.get||u.set)?Object.defineProperty(n,c,u):n[c]=a[c]}return n.default=a,i&&i.set(a,n),n}var st=(0,at.default)((0,rt.jsx)("path",{d:"M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"}),"Apple");Y=D.default=st;var M={},nt=g;Object.defineProperty(M,"__esModule",{value:!0});var ee=M.default=void 0,lt=nt(m()),it=e,ct=(0,lt.default)((0,it.jsx)("path",{d:"M20 18v-1c1.1 0 1.99-.9 1.99-2L22 5c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2v1H0v2h24v-2h-4zM4 5h16v10H4V5z"}),"LaptopWindows");ee=M.default=ct;var O={},dt=g;Object.defineProperty(O,"__esModule",{value:!0});var te=O.default=void 0,ut=dt(m()),pt=e,ht=(0,ut.default)((0,pt.jsx)("path",{d:"M4 6h18V4H4c-1.1 0-2 .9-2 2v11H0v3h14v-3H4V6zm19 2h-6c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h6c.55 0 1-.45 1-1V9c0-.55-.45-1-1-1zm-1 9h-4v-7h4v7z"}),"Devices");te=O.default=ht;function vt(){var I,z,U,B,H,W,w,F,q,E,N;const a=xe(t=>t.showSnackbar),[l,i]=fe(),[n,v]=h.useState(!1),[c,u]=h.useState(!1),[j,b]=h.useState(!1),[ae,A]=h.useState(null),[r,re]=h.useState({}),[oe,se]=h.useState(l.get("tab")||"all"),ne=(t,s)=>{se(s),i({tab:s}),T()};h.useEffect(()=>{T()},[]);const T=()=>{v(!0);const t=new URL(`${_}/blocking/report/activation`);fetch(t).then(s=>s.json()).then(s=>{re(s)}).finally(()=>v(!1))},le=()=>{u(!0);const t=new URL(`${_}/blocking/report/activation`);fetch(t,{method:"POST"}).then(s=>s.json()).then(()=>{T(),a("El consolidado se generÃ³ correctamente","success")}).finally(()=>u(!1))},ie=()=>{b(!0);const t=new URL(`${_}/blocking/report/activation/download`);let s="";fetch(t).then(d=>{const f=d.headers.get("Content-Disposition");return f&&(s=f.split(";")[1].split("=")[1].replaceAll('"',"")),d.blob()}).then(d=>URL.createObjectURL(d)).then(d=>{Object.assign(document.createElement("a"),{href:d,download:s}).click()}).finally(()=>{b(!1)})},ce=(t,s)=>{v(!0),A(s);const d=new URL(`${_}/blocking/report/customers`),f={name:t};d.search=new URLSearchParams(f).toString();let x="";fetch(d).then(p=>{const V=p.headers.get("Content-Disposition");return V&&(x=V.split(";")[1].split("=")[1].replaceAll('"',"")),p.blob()}).then(p=>URL.createObjectURL(p)).then(p=>{Object.assign(document.createElement("a"),{href:p,download:x}).click()}).finally(()=>{A(null),v(!1)})},de=()=>{le()},ue=()=>{ie()},pe=(t,s)=>{ce(t,s)};return e.jsx(me,{sx:{mt:4,mb:4},children:e.jsx(je,{variant:"outlined",sx:{position:"relative"},children:e.jsxs(_e,{value:oe,children:[e.jsx(Q,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(Re,{onChange:ne,indicatorColor:"secondary",children:[e.jsx(R,{icon:e.jsx(te,{}),iconPosition:"start",label:"Todos",value:"all"}),e.jsx(R,{icon:e.jsx(X,{}),iconPosition:"start",label:"Android",value:"android",disabled:!0}),e.jsx(R,{icon:e.jsx(Y,{}),iconPosition:"start",label:"iOS",value:"ios",disabled:!0}),e.jsx(R,{icon:e.jsx(ee,{}),iconPosition:"start",label:"Windows",value:"windows",disabled:!0})]})}),e.jsxs(C,{value:"all",sx:{padding:0},children:[e.jsxs(Ce,{children:[e.jsx(be,{variant:"h6",noWrap:!0,component:"div",color:"primary",sx:{flexGrow:1,display:{xs:"none",sm:"block"}},children:"Consolidado"}),e.jsxs(Q,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(P,{size:"small",color:"primary",startIcon:e.jsx(K,{}),onClick:()=>de(),disabled:((I=r==null?void 0:r.activationReport)==null?void 0:I.length)!==0,loading:c,children:"Generar"}),e.jsx(P,{size:"small",color:"primary",startIcon:e.jsx($,{}),onClick:()=>ue(),disabled:n||((z=r==null?void 0:r.activationReport)==null?void 0:z.length)===0,loading:j,children:"Descargar reporte (.xlsx)"})]})]}),n&&e.jsx(Te,{sx:{position:"absolute",top:"0",left:0,right:0,borderRadius:4,zIndex:3}}),e.jsx(Pe,{sx:{maxHeight:551},children:e.jsxs($e,{stickyHeader:!0,size:"small",children:[e.jsx(Se,{children:e.jsxs(y,{children:[e.jsx(o,{children:"Cliente"}),e.jsx(o,{align:"right",children:"Facturables"}),e.jsx(o,{align:"right",children:"No Facturables"}),e.jsx(o,{align:"right",children:"APS"}),e.jsx(o,{align:"right",children:"APQ"}),e.jsx(o,{align:"right",children:"Acciones"})]})}),e.jsx(Le,{children:(U=r==null?void 0:r.activationReport)==null?void 0:U.map((t,s)=>{var d,f,x,p;return e.jsxs(y,{children:[e.jsx(o,{component:"th",scope:"row",children:t==null?void 0:t.customerName}),e.jsx(o,{align:"right",children:(d=t==null?void 0:t._sum)==null?void 0:d.billable}),e.jsx(o,{align:"right",children:(f=t==null?void 0:t._sum)==null?void 0:f.nonBillable}),e.jsx(o,{align:"right",children:(x=t==null?void 0:t._sum)==null?void 0:x.billableWeekly}),e.jsx(o,{align:"right",children:(p=t==null?void 0:t._sum)==null?void 0:p.billableBiweekly}),e.jsx(o,{children:e.jsx(ke,{direction:"row",spacing:1,justifyContent:"flex-end",children:e.jsx(P,{size:"small",color:"primary",startIcon:e.jsx($,{}),onClick:()=>pe(t==null?void 0:t.customerName,s),disabled:n,loading:ae===s,children:"Exportar (.csv)"})})})]},t==null?void 0:t.customerName)})}),e.jsxs(Fe,{sx:{left:0,bottom:0,zIndex:2,position:"sticky"},children:[e.jsx(y,{sx:{backgroundColor:"white"},children:e.jsx(o,{colSpan:6,sx:{padding:0}})}),e.jsxs(y,{sx:{backgroundColor:"white"},children:[e.jsx(o,{variant:"head",children:"Totales"}),e.jsx(o,{align:"right",variant:"head",children:(H=(B=r==null?void 0:r.activationReportTotals)==null?void 0:B._sum)==null?void 0:H.billable}),e.jsx(o,{align:"right",variant:"head",children:(w=(W=r==null?void 0:r.activationReportTotals)==null?void 0:W._sum)==null?void 0:w.nonBillable}),e.jsx(o,{align:"right",variant:"head",children:(q=(F=r==null?void 0:r.activationReportTotals)==null?void 0:F._sum)==null?void 0:q.billableWeekly}),e.jsx(o,{align:"right",variant:"head",children:(N=(E=r==null?void 0:r.activationReportTotals)==null?void 0:E._sum)==null?void 0:N.billableBiweekly}),e.jsx(o,{})]})]})]})})]}),e.jsx(C,{value:"android"}),e.jsx(C,{value:"ios"}),e.jsx(C,{value:"windows"})]})})})}function Mt(){return e.jsx(Ie,{title:"Consolidado",children:e.jsx(vt,{})})}export{Mt as default};
