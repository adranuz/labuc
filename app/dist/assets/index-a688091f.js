import{j as o,c as l,_ as y,b as v,r as C,u as aa,a as ea,f as oa,i as ra}from"./index-b42bb106.js";import{d as la,D as ia,a as ta,b as na,c as sa,e as ca,f as da,g as pa}from"./Delete-6bc3e474.js";import{d as ga}from"./Search-f763a38f.js";import{u as ua}from"./common-f20c29b3.js";import{a as G}from"./api-8c80c0c6.js";import{B as L,P as ba}from"./Page-d4992afd.js";import{A as fa}from"./Alert-5b357520.js";import{B as F}from"./Box-244d35cf.js";import{c as Ca,g as ma,u as va,B as q,T as N,b as A,P as xa}from"./Typography-97eb5159.js";import{L as $a}from"./LoadingButton-81671c98.js";import{g as ha,E as z,c as R,a as ya}from"./styled-82e1a40e.js";import{I as ka}from"./Select-b0379f96.js";import{T as ja}from"./Toolbar-d2130989.js";import{L as Ia,T as Pa,a as Ra,b as Sa,c as K,d as k,e as Ta}from"./TableRow-1b9ea06e.js";import{S as H}from"./Stack-ea032fd5.js";import{T as za}from"./TablePagination-8f236e51.js";import{C as Da}from"./Container-39c7183f.js";import"./Backdrop-8d503ce4.js";import"./Menu-8b8cdc95.js";import"./createSvgIcon-d23abb9c.js";import"./KeyboardArrowRight-92e666a9.js";import"./MenuItem-d7a9b7ba.js";import"./dividerClasses-994ab282.js";const La=Ca(o.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");function Ea(a){return ha("MuiChip",a)}const Oa=ma("MuiChip",["root","sizeSmall","sizeMedium","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),r=Oa,Ua=["avatar","className","clickable","color","component","deleteIcon","disabled","icon","label","onClick","onDelete","onKeyDown","onKeyUp","size","variant","tabIndex","skipFocusWhenDisabled"],Ba=a=>{const{classes:e,disabled:g,size:n,color:s,iconColor:d,onDelete:x,clickable:c,variant:u}=a,b={root:["root",u,g&&"disabled",`size${l(n)}`,`color${l(s)}`,c&&"clickable",c&&`clickableColor${l(s)}`,x&&"deletable",x&&`deletableColor${l(s)}`,`${u}${l(s)}`],label:["label",`label${l(n)}`],avatar:["avatar",`avatar${l(n)}`,`avatarColor${l(s)}`],icon:["icon",`icon${l(n)}`,`iconColor${l(d)}`],deleteIcon:["deleteIcon",`deleteIcon${l(n)}`,`deleteIconColor${l(s)}`,`deleteIcon${l(u)}Color${l(s)}`]};return ya(b,Ea,e)},wa=z("div",{name:"MuiChip",slot:"Root",overridesResolver:(a,e)=>{const{ownerState:g}=a,{color:n,iconColor:s,clickable:d,onDelete:x,size:c,variant:u}=g;return[{[`& .${r.avatar}`]:e.avatar},{[`& .${r.avatar}`]:e[`avatar${l(c)}`]},{[`& .${r.avatar}`]:e[`avatarColor${l(n)}`]},{[`& .${r.icon}`]:e.icon},{[`& .${r.icon}`]:e[`icon${l(c)}`]},{[`& .${r.icon}`]:e[`iconColor${l(s)}`]},{[`& .${r.deleteIcon}`]:e.deleteIcon},{[`& .${r.deleteIcon}`]:e[`deleteIcon${l(c)}`]},{[`& .${r.deleteIcon}`]:e[`deleteIconColor${l(n)}`]},{[`& .${r.deleteIcon}`]:e[`deleteIcon${l(u)}Color${l(n)}`]},e.root,e[`size${l(c)}`],e[`color${l(n)}`],d&&e.clickable,d&&n!=="default"&&e[`clickableColor${l(n)})`],x&&e.deletable,x&&n!=="default"&&e[`deletableColor${l(n)}`],e[u],e[`${u}${l(n)}`]]}})(({theme:a,ownerState:e})=>{const g=a.palette.mode==="light"?a.palette.grey[700]:a.palette.grey[300];return y({maxWidth:"100%",fontFamily:a.typography.fontFamily,fontSize:a.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(a.vars||a).palette.text.primary,backgroundColor:(a.vars||a).palette.action.selected,borderRadius:32/2,whiteSpace:"nowrap",transition:a.transitions.create(["background-color","box-shadow"]),cursor:"default",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${r.disabled}`]:{opacity:(a.vars||a).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${r.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:a.vars?a.vars.palette.Chip.defaultAvatarColor:g,fontSize:a.typography.pxToRem(12)},[`& .${r.avatarColorPrimary}`]:{color:(a.vars||a).palette.primary.contrastText,backgroundColor:(a.vars||a).palette.primary.dark},[`& .${r.avatarColorSecondary}`]:{color:(a.vars||a).palette.secondary.contrastText,backgroundColor:(a.vars||a).palette.secondary.dark},[`& .${r.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:a.typography.pxToRem(10)},[`& .${r.icon}`]:y({marginLeft:5,marginRight:-6},e.size==="small"&&{fontSize:18,marginLeft:4,marginRight:-4},e.iconColor===e.color&&y({color:a.vars?a.vars.palette.Chip.defaultIconColor:g},e.color!=="default"&&{color:"inherit"})),[`& .${r.deleteIcon}`]:y({WebkitTapHighlightColor:"transparent",color:a.vars?`rgba(${a.vars.palette.text.primaryChannel} / 0.26)`:v(a.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:a.vars?`rgba(${a.vars.palette.text.primaryChannel} / 0.4)`:v(a.palette.text.primary,.4)}},e.size==="small"&&{fontSize:16,marginRight:4,marginLeft:-4},e.color!=="default"&&{color:a.vars?`rgba(${a.vars.palette[e.color].contrastTextChannel} / 0.7)`:v(a.palette[e.color].contrastText,.7),"&:hover, &:active":{color:(a.vars||a).palette[e.color].contrastText}})},e.size==="small"&&{height:24},e.color!=="default"&&{backgroundColor:(a.vars||a).palette[e.color].main,color:(a.vars||a).palette[e.color].contrastText},e.onDelete&&{[`&.${r.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.focusOpacity}))`:v(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.focusOpacity)}},e.onDelete&&e.color!=="default"&&{[`&.${r.focusVisible}`]:{backgroundColor:(a.vars||a).palette[e.color].dark}})},({theme:a,ownerState:e})=>y({},e.clickable&&{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.hoverOpacity}))`:v(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.hoverOpacity)},[`&.${r.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.focusOpacity}))`:v(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.focusOpacity)},"&:active":{boxShadow:(a.vars||a).shadows[1]}},e.clickable&&e.color!=="default"&&{[`&:hover, &.${r.focusVisible}`]:{backgroundColor:(a.vars||a).palette[e.color].dark}}),({theme:a,ownerState:e})=>y({},e.variant==="outlined"&&{backgroundColor:"transparent",border:a.vars?`1px solid ${a.vars.palette.Chip.defaultBorder}`:`1px solid ${a.palette.mode==="light"?a.palette.grey[400]:a.palette.grey[700]}`,[`&.${r.clickable}:hover`]:{backgroundColor:(a.vars||a).palette.action.hover},[`&.${r.focusVisible}`]:{backgroundColor:(a.vars||a).palette.action.focus},[`& .${r.avatar}`]:{marginLeft:4},[`& .${r.avatarSmall}`]:{marginLeft:2},[`& .${r.icon}`]:{marginLeft:4},[`& .${r.iconSmall}`]:{marginLeft:2},[`& .${r.deleteIcon}`]:{marginRight:5},[`& .${r.deleteIconSmall}`]:{marginRight:3}},e.variant==="outlined"&&e.color!=="default"&&{color:(a.vars||a).palette[e.color].main,border:`1px solid ${a.vars?`rgba(${a.vars.palette[e.color].mainChannel} / 0.7)`:v(a.palette[e.color].main,.7)}`,[`&.${r.clickable}:hover`]:{backgroundColor:a.vars?`rgba(${a.vars.palette[e.color].mainChannel} / ${a.vars.palette.action.hoverOpacity})`:v(a.palette[e.color].main,a.palette.action.hoverOpacity)},[`&.${r.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette[e.color].mainChannel} / ${a.vars.palette.action.focusOpacity})`:v(a.palette[e.color].main,a.palette.action.focusOpacity)},[`& .${r.deleteIcon}`]:{color:a.vars?`rgba(${a.vars.palette[e.color].mainChannel} / 0.7)`:v(a.palette[e.color].main,.7),"&:hover, &:active":{color:(a.vars||a).palette[e.color].main}}})),Fa=z("span",{name:"MuiChip",slot:"Label",overridesResolver:(a,e)=>{const{ownerState:g}=a,{size:n}=g;return[e.label,e[`label${l(n)}`]]}})(({ownerState:a})=>y({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap"},a.size==="small"&&{paddingLeft:8,paddingRight:8}));function J(a){return a.key==="Backspace"||a.key==="Delete"}const Na=C.forwardRef(function(e,g){const n=aa({props:e,name:"MuiChip"}),{avatar:s,className:d,clickable:x,color:c="default",component:u,deleteIcon:b,disabled:j=!1,icon:h,label:S,onClick:P,onDelete:$,onKeyDown:m,onKeyUp:i,size:p="medium",variant:t="filled",tabIndex:D,skipFocusWhenDisabled:E=!1}=n,T=ea(n,Ua),O=C.useRef(null),Q=va(O,g),V=f=>{f.stopPropagation(),$&&$(f)},X=f=>{f.currentTarget===f.target&&J(f)&&f.preventDefault(),m&&m(f)},Y=f=>{f.currentTarget===f.target&&($&&J(f)?$(f):f.key==="Escape"&&O.current&&O.current.blur()),i&&i(f)},U=x!==!1&&P?!0:x,B=U||$?q:u||"div",w=y({},n,{component:B,disabled:j,size:p,color:c,iconColor:C.isValidElement(h)&&h.props.color||c,onDelete:!!$,clickable:U,variant:t}),I=Ba(w),Z=B===q?y({component:u||"div",focusVisibleClassName:I.focusVisible},$&&{disableRipple:!0}):{};let M=null;$&&(M=b&&C.isValidElement(b)?C.cloneElement(b,{className:R(b.props.className,I.deleteIcon),onClick:V}):o.jsx(La,{className:R(I.deleteIcon),onClick:V}));let W=null;s&&C.isValidElement(s)&&(W=C.cloneElement(s,{className:R(I.avatar,s.props.className)}));let _=null;return h&&C.isValidElement(h)&&(_=C.cloneElement(h,{className:R(I.icon,h.props.className)})),o.jsxs(wa,y({as:B,className:R(I.root,d),disabled:U&&j?!0:void 0,onClick:P,onKeyDown:X,onKeyUp:Y,ref:Q,tabIndex:E&&j?-1:D,ownerState:w},Z,T,{children:[W||_,o.jsx(Fa,{className:R(I.label),ownerState:w,children:S}),M]}))}),Va=Na;function Ma({id:a,name:e,onFinished:g}){var $;const[n,s]=C.useState(!1),[d,x]=C.useState(!1),c=ua(m=>m.showSnackbar),u=()=>{s(!0)},b=()=>{s(!1)},j=()=>{h({id:a})},h=({id:m})=>{x(!0);const i=new URL(`${G}/users/${m}`);fetch(i,{method:"DELETE"}).then(p=>p.json()).then(p=>{c("El usuario se eliminó corretamente","success"),g()}).catch(p=>c("Error al intentar eliminar el usuario","error")).finally(()=>{s(!1),x(!1)})},S=()=>{const m=localStorage.getItem("token");if(m)return P(m)},P=m=>JSON.parse(decodeURIComponent(escape(atob(m.split(".")[1]))));return o.jsxs(o.Fragment,{children:[o.jsx(L,{size:"small",color:"error",startIcon:o.jsx(la,{}),onClick:u,disabled:a===(($=S())==null?void 0:$.id),children:"Eliminar"}),o.jsxs(ia,{fullWidth:!0,maxWidth:"sm",open:n,onClose:b,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[o.jsx(ta,{id:"alert-dialog-title",children:"Eliminar usuario"}),o.jsxs(na,{children:[o.jsxs(sa,{id:"alert-dialog-description",children:[o.jsx(fa,{severity:"error",children:"Depués de eliminar un usuario, este se borra de manera permanente. Esta acción no se puede deshacer."}),o.jsxs(F,{m:2,children:[o.jsx(N,{variant:"caption",children:"Nombre del usuario"}),o.jsx(N,{mt:1,color:"black",children:e})]})]}),o.jsxs(ca,{children:[o.jsx(L,{size:"small",onClick:b,children:"Cancelar"}),o.jsx($a,{loading:d,variant:"contained",color:"error",size:"small",loadingPosition:"start",disableElevation:!0,autoFocus:!0,onClick:j,children:"Eliminar"})]})]})]})]})}const Wa=z("div")(({theme:a})=>({position:"relative",borderRadius:a.shape.borderRadius,backgroundColor:A().palette.mode==="dark"?v(a.palette.common.white,.15):v(a.palette.common.black,.05),"&:hover":{backgroundColor:A().palette.mode==="dark"?v(a.palette.common.white,.25):v(a.palette.common.black,.15)},marginLeft:0,width:"100%",[a.breakpoints.up("sm")]:{marginLeft:a.spacing(1),width:"auto"}})),_a=z("div")(({theme:a})=>({padding:a.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"})),qa=z(ka)(({theme:a})=>({color:"inherit","& .MuiInputBase-input":{padding:a.spacing(1,1,1,0),paddingLeft:`calc(1em + ${a.spacing(4)})`,transition:a.transitions.create("width"),width:"100%",[a.breakpoints.up("sm")]:{width:"12ch","&:focus":{width:"20ch"}}}}));function Aa(){var m;const a=oa(),[e,g]=ra(),[n,s]=C.useState(!1),[d,x]=C.useState({}),[c,u]=C.useState({perPage:parseInt(e.get("perPage")||"10"),page:parseInt(e.get("page")||"0"),q:e.get("q")||""});C.useEffect(()=>{b(c)},[]);const b=({perPage:i,page:p,q:t})=>{s(!0);const D=new URL(`${G}/users`),E={perPage:String(i),page:String(p),q:t};D.search=new URLSearchParams(E).toString(),fetch(D).then(async T=>await T.json()).then(T=>{x(T)}).finally(()=>s(!1))},j=(i,p)=>{const t={...c,page:p};u(t),b(t),g({perPage:String(t.perPage),page:String(t.page),q:t.q})},h=i=>{const p=parseInt(i.target.value),t={...c,perPage:p,page:0};u(t),b(t),g({perPage:String(t.perPage),page:String(t.page),q:t.q})},S=i=>{const p=i.target.value,t={...c,q:p,page:0};u(t),b(t),g({perPage:String(t.perPage),page:String(t.page),q:t.q})},P=i=>{a(`/admin/users/${i}/edit`)},$=()=>{a("/admin/users/create")};return o.jsx(F,{sx:{width:"100%",position:"relative"},children:o.jsxs(xa,{variant:"outlined",sx:{width:"100%",mb:2},children:[o.jsxs(ja,{children:[o.jsx(N,{component:"h2",variant:"h5",noWrap:!0,color:"primary",sx:{flexGrow:1,display:{xs:"none",sm:"block"}},children:"Usuarios"}),o.jsxs(F,{sx:{display:"flex",alignItems:"center",gap:2},children:[o.jsxs(Wa,{children:[o.jsx(_a,{children:o.jsx(ga,{})}),o.jsx(qa,{placeholder:"Buscar…",type:"search",inputProps:{"aria-label":"search"},onChange:S,defaultValue:e.get("q")})]}),o.jsx(L,{size:"small",color:"primary",startIcon:o.jsx(da,{}),onClick:()=>$(),children:"Agregar"})]})]}),n&&o.jsx(Ia,{sx:{position:"absolute",top:"0",left:0,right:0,borderTopLeftRadius:4,borderTopRightRadius:4}}),o.jsx(Pa,{children:o.jsxs(Ra,{size:"small",children:[o.jsx(Sa,{children:o.jsxs(K,{children:[o.jsx(k,{children:"Nombre"}),o.jsx(k,{children:"Correo electrónico"}),o.jsx(k,{children:"Roles"}),o.jsx(k,{align:"right",children:"Acciones"})]})}),o.jsx(Ta,{children:(m=d==null?void 0:d.data)==null?void 0:m.map(i=>{var p;return o.jsxs(K,{children:[o.jsx(k,{children:i.name}),o.jsx(k,{children:i.email}),o.jsx(k,{children:o.jsx(H,{direction:"row",spacing:1,children:(p=i.roles)==null?void 0:p.map(t=>o.jsx(Va,{label:t.name,variant:"outlined",size:"small",color:"primary",sx:{textTransform:"capitalize"}},t.name))})}),o.jsx(k,{children:o.jsxs(H,{direction:"row",spacing:1,justifyContent:"flex-end",children:[o.jsx(L,{size:"small",color:"info",startIcon:o.jsx(pa,{}),onClick:()=>P(i.id),children:"Editar"}),o.jsx(Ma,{id:i.id,name:i.name,onFinished:()=>b(c)})]})})]},i.id)})})]})}),o.jsx(za,{rowsPerPageOptions:[5,10,25,100],component:"div",count:(d==null?void 0:d.total)||0,rowsPerPage:c.perPage,page:(d==null?void 0:d.page)||0,onPageChange:j,onRowsPerPageChange:h,labelRowsPerPage:"Filas por página:",labelDisplayedRows:({from:i,to:p,count:t})=>`${i}-${p} de ${t}`,showFirstButton:!0,showLastButton:!0,getItemAriaLabel:i=>i==="first"?"Ir a la primera página":i==="last"?"Ir a la última página":i==="next"?"Ir a la página siguiente":"Regresar a la pagina anterior"})]})})}function Ka(){return o.jsx(Da,{sx:{mt:4,mb:4},children:o.jsx(Aa,{})})}function Ce(){return o.jsx(ba,{title:"Usuarios",children:o.jsx(Ka,{})})}export{Ce as default};
