import{r as v,u as ee,a as te,_ as N,j as e,i as ae}from"./index-91ff4d49.js";import{r as y,i as C}from"./createSvgIcon-25bf66cb.js";import{a as I}from"./api-ff746449.js";import{f as re,T as se,a as oe,b as ne,c as M,d as r,e as ie,L as le}from"./TableRow-d39016a2.js";import{S as ce}from"./Stack-e73cbfe4.js";import{L as z}from"./LoadingButton-6727ca29.js";import{g as de,E as ue,c as pe,a as he}from"./styled-a2b7b371.js";import{g as ve,T as fe,P as xe}from"./Typography-cb915fe9.js";import{u as me}from"./common-50bec2fc.js";import{C as ge}from"./Container-8edad11d.js";import{T as je}from"./Toolbar-9b11f623.js";import{B as V}from"./Box-fb4d2aa9.js";import{T as be,a as _e,b as A,c as O}from"./TabPanel-62fab7f2.js";import{P as Re}from"./Page-c343cc43.js";import"./useSlotProps-fd3197d9.js";import"./KeyboardArrowRight-ca7feddd.js";function Te(t){return de("MuiTableFooter",t)}ve("MuiTableFooter",["root"]);const ye=["className","component"],Ce=t=>{const{classes:i}=t;return he({root:["root"]},Te,i)},Pe=ue("tfoot",{name:"MuiTableFooter",slot:"Root",overridesResolver:(t,i)=>i.root})({display:"table-footer-group"}),Se={variant:"footer"},G="tfoot",Le=v.forwardRef(function(i,l){const s=ee({props:i,name:"MuiTableFooter"}),{className:x,component:n=G}=s,u=te(s,ye),R=N({},s,{component:n}),j=Ce(R);return e.jsx(re.Provider,{value:Se,children:e.jsx(Pe,N({as:n,className:pe(j.root,x),ref:l,role:n===G?null:"rowgroup",ownerState:R},u))})}),$e=Le;var U={},De=C;Object.defineProperty(U,"__esModule",{value:!0});var Q=U.default=void 0,Me=De(y()),Ae=e,Oe=(0,Me.default)((0,Ae.jsx)("path",{d:"m22.7 19-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4z"}),"Build");Q=U.default=Oe;var B={},ke=C;Object.defineProperty(B,"__esModule",{value:!0});var w=B.default=void 0,Ie=ke(y()),ze=e,Ue=(0,Ie.default)((0,ze.jsx)("path",{d:"M5 20h14v-2H5v2zM19 9h-4V3H9v6H5l7 7 7-7z"}),"Download");w=B.default=Ue;var H={},Be=C;Object.defineProperty(H,"__esModule",{value:!0});var J=H.default=void 0,we=Be(y()),He=e,We=(0,we.default)((0,He.jsx)("path",{d:"m17.6 9.48 1.84-3.18c.16-.31.04-.69-.26-.85-.29-.15-.65-.06-.83.22l-1.88 3.24c-2.86-1.21-6.08-1.21-8.94 0L5.65 5.67c-.19-.29-.58-.38-.87-.2-.28.18-.37.54-.22.83L6.4 9.48C3.3 11.25 1.28 14.44 1 18h22c-.28-3.56-2.3-6.75-5.4-8.52zM7 15.25c-.69 0-1.25-.56-1.25-1.25s.56-1.25 1.25-1.25 1.25.56 1.25 1.25-.56 1.25-1.25 1.25zm10 0c-.69 0-1.25-.56-1.25-1.25s.56-1.25 1.25-1.25 1.25.56 1.25 1.25-.56 1.25-1.25 1.25z"}),"Android");J=H.default=We;var W={},Fe=C;Object.defineProperty(W,"__esModule",{value:!0});var K=W.default=void 0;Ne(v);var qe=Fe(y()),Ee=e;function X(t){if(typeof WeakMap!="function")return null;var i=new WeakMap,l=new WeakMap;return(X=function(s){return s?l:i})(t)}function Ne(t,i){if(!i&&t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var l=X(i);if(l&&l.has(t))return l.get(t);var s={},x=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in t)if(n!=="default"&&Object.prototype.hasOwnProperty.call(t,n)){var u=x?Object.getOwnPropertyDescriptor(t,n):null;u&&(u.get||u.set)?Object.defineProperty(s,n,u):s[n]=t[n]}return s.default=t,l&&l.set(t,s),s}var Ve=(0,qe.default)((0,Ee.jsx)("path",{d:"M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"}),"Apple");K=W.default=Ve;var F={},Ge=C;Object.defineProperty(F,"__esModule",{value:!0});var Y=F.default=void 0,Qe=Ge(y()),Je=e,Ke=(0,Qe.default)((0,Je.jsx)("path",{d:"M20 18v-1c1.1 0 1.99-.9 1.99-2L22 5c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2v1H0v2h24v-2h-4zM4 5h16v10H4V5z"}),"LaptopWindows");Y=F.default=Ke;var q={},Xe=C;Object.defineProperty(q,"__esModule",{value:!0});var Z=q.default=void 0,Ye=Xe(y()),Ze=e,et=(0,Ye.default)((0,Ze.jsx)("path",{d:"M4 6h18V4H4c-1.1 0-2 .9-2 2v11H0v3h14v-3H4V6zm19 2h-6c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h6c.55 0 1-.45 1-1V9c0-.55-.45-1-1-1zm-1 9h-4v-7h4v7z"}),"Devices");Z=q.default=et;function k({data:t,deviceType:i}){var j,c,P,p,S,L,T,$,D;const[l,s]=v.useState(!1),[x,n]=v.useState(null),u=(a,m,b)=>{s(!0),n(b);const g=new URL(`${I}/blocking/report/customer/download`),d={deviceType:a,name:m};g.search=new URLSearchParams(d).toString();let o="";fetch(g).then(h=>{const f=h.headers.get("Content-Disposition");return f&&(o=f.split(";")[1].split("=")[1].replaceAll('"',"")),h.blob()}).then(h=>URL.createObjectURL(h)).then(h=>{Object.assign(document.createElement("a"),{href:h,download:o}).click()}).finally(()=>{n(null),s(!1)})},R=(a,m)=>{u(i,a,m)};return e.jsx(se,{sx:{maxHeight:551},children:e.jsxs(oe,{stickyHeader:!0,size:"small",children:[e.jsx(ne,{children:e.jsxs(M,{children:[e.jsx(r,{children:"Cliente"}),e.jsx(r,{align:"right",children:"Facturables"}),e.jsx(r,{align:"right",children:"No Facturables"}),e.jsx(r,{align:"right",children:"APS"}),e.jsx(r,{align:"right",children:"APQ"}),e.jsx(r,{align:"right",children:"Acciones"})]})}),e.jsx(ie,{children:(j=t==null?void 0:t.activationReport)==null?void 0:j.map((a,m)=>{var b,g,d,o;return e.jsxs(M,{children:[e.jsx(r,{component:"th",scope:"row",children:a==null?void 0:a.customerName}),e.jsx(r,{align:"right",children:(b=a==null?void 0:a._sum)==null?void 0:b.billable}),e.jsx(r,{align:"right",children:(g=a==null?void 0:a._sum)==null?void 0:g.nonBillable}),e.jsx(r,{align:"right",children:(d=a==null?void 0:a._sum)==null?void 0:d.billableWeekly}),e.jsx(r,{align:"right",children:(o=a==null?void 0:a._sum)==null?void 0:o.billableBiweekly}),e.jsx(r,{children:e.jsx(ce,{direction:"row",spacing:1,justifyContent:"flex-end",children:e.jsx(z,{size:"small",color:"primary",startIcon:e.jsx(w,{}),onClick:()=>R(a==null?void 0:a.customerName,m),disabled:l,loading:x===m,children:"Exportar (.csv)"})})})]},a==null?void 0:a.customerName)})}),e.jsxs($e,{sx:{left:0,bottom:0,zIndex:2,position:"sticky"},children:[e.jsx(M,{children:e.jsx(r,{colSpan:6,sx:{padding:0}})}),e.jsxs(M,{children:[e.jsx(r,{variant:"head",children:"Totales"}),e.jsx(r,{align:"right",variant:"head",children:(P=(c=t==null?void 0:t.activationReportTotals)==null?void 0:c._sum)==null?void 0:P.billable}),e.jsx(r,{align:"right",variant:"head",children:(S=(p=t==null?void 0:t.activationReportTotals)==null?void 0:p._sum)==null?void 0:S.nonBillable}),e.jsx(r,{align:"right",variant:"head",children:(T=(L=t==null?void 0:t.activationReportTotals)==null?void 0:L._sum)==null?void 0:T.billableWeekly}),e.jsx(r,{align:"right",variant:"head",children:(D=($=t==null?void 0:t.activationReportTotals)==null?void 0:$._sum)==null?void 0:D.billableBiweekly}),e.jsx(r,{align:"right",variant:"head"})]})]})]})})}function tt(){var b,g;const t=me(d=>d.showSnackbar),[i,l]=ae(),[s,x]=v.useState(!1),[n,u]=v.useState(!1),[R,j]=v.useState(!1),[c,P]=v.useState({}),[p,S]=v.useState(i.get("tab")||"all"),L=(d,o)=>{S(o),l({tab:o}),T(o)};v.useEffect(()=>{T(p)},[]);const T=d=>{x(!0);const o=new URL(`${I}/blocking/report/activation`),h={deviceType:d};o.search=new URLSearchParams(h).toString(),fetch(o).then(f=>f.json()).then(f=>{P(f)}).finally(()=>x(!1))},$=()=>{u(!0);const d=new URL(`${I}/blocking/report/activation`);fetch(d,{method:"POST"}).then(o=>o.json()).then(()=>{T(p),t("El consolidado se generÃ³ correctamente","success")}).finally(()=>u(!1))},D=d=>{j(!0);const o=new URL(`${I}/blocking/report/activation/download`),h={deviceType:d};o.search=new URLSearchParams(h).toString();let f="";fetch(o).then(_=>{const E=_.headers.get("Content-Disposition");return E&&(f=E.split(";")[1].split("=")[1].replaceAll('"',"")),_.blob()}).then(_=>URL.createObjectURL(_)).then(_=>{Object.assign(document.createElement("a"),{href:_,download:f}).click()}).finally(()=>{j(!1)})},a=()=>{$()},m=()=>{D(p)};return e.jsxs(ge,{sx:{mt:4,mb:4},children:[e.jsxs(je,{disableGutters:!0,children:[e.jsx(fe,{component:"h1",variant:"h6",noWrap:!0,sx:{flexGrow:1},children:"Consolidado"}),e.jsxs(V,{sx:{display:"flex",gap:2},children:[e.jsx(z,{size:"small",color:"primary",startIcon:e.jsx(Q,{}),onClick:()=>a(),disabled:((b=c==null?void 0:c.activationReport)==null?void 0:b.length)!==0,loading:n,children:"Generar"}),e.jsx(z,{size:"small",color:"primary",startIcon:e.jsx(w,{}),onClick:()=>m(),disabled:s||((g=c==null?void 0:c.activationReport)==null?void 0:g.length)===0,loading:R,children:"Descargar reporte (.xlsx)"})]})]}),e.jsx(xe,{variant:"outlined",sx:{position:"relative"},children:e.jsxs(be,{value:p,children:[e.jsx(V,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(_e,{onChange:L,indicatorColor:"secondary",children:[e.jsx(A,{icon:e.jsx(Z,{}),iconPosition:"start",label:"Todos",value:"all"}),e.jsx(A,{icon:e.jsx(J,{}),iconPosition:"start",label:"Android",value:"android"}),e.jsx(A,{icon:e.jsx(K,{}),iconPosition:"start",label:"iOS",value:"ios"}),e.jsx(A,{icon:e.jsx(Y,{}),iconPosition:"start",label:"Windows",value:"windows"})]})}),s&&e.jsx(le,{sx:{position:"absolute",top:"0",left:0,right:0,borderRadius:4,zIndex:3}}),e.jsx(O,{value:"all",sx:{padding:0},children:e.jsx(k,{data:c,deviceType:p})}),e.jsx(O,{value:"android",sx:{padding:0},children:e.jsx(k,{data:c,deviceType:p})}),e.jsx(O,{value:"ios",sx:{padding:0},children:e.jsx(k,{data:c,deviceType:p})}),e.jsx(O,{value:"windows",sx:{padding:0},children:e.jsx(k,{data:c,deviceType:p})})]})})]})}function jt(){return e.jsx(Re,{title:"Consolidado",children:e.jsx(tt,{})})}export{jt as default};
