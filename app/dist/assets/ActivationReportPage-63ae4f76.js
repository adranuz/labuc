import{r as d,u as X,_ as Y,a as z,j as e}from"./index-667db33b.js";import{r as N,i as H}from"./createSvgIcon-54f46e3e.js";import{a as g}from"./api-8c80c0c6.js";import{C as Z}from"./Container-fd0440dd.js";import{B as M}from"./Box-65681191.js";import{g as w,P as ee,T as te}from"./Typography-e2bfb966.js";import{T as se}from"./Toolbar-f36ec5e6.js";import{L as v}from"./LoadingButton-c6ae99a2.js";import{f as oe,L as ae,T as le,a as ne,b as ie,c as f,d as o,e as re,S as ce}from"./TableRow-fb5d603d.js";import{g as de,E as ue,a as pe,c as he}from"./styled-c006b7d0.js";import{P as me}from"./Page-19bea9d1.js";function xe(i){return de("MuiTableFooter",i)}w("MuiTableFooter",["root"]);const ge=["className","component"],fe=i=>{const{classes:n}=i;return he({root:["root"]},xe,n)},be=ue("tfoot",{name:"MuiTableFooter",slot:"Root",overridesResolver:(i,n)=>n.root})({display:"table-footer-group"}),je={variant:"footer"},E="tfoot",ve=d.forwardRef(function(n,x){const u=X({props:n,name:"MuiTableFooter"}),{className:b,component:p=E}=u,j=Y(u,ge),m=z({},u,{component:p}),s=fe(m);return e.jsx(oe.Provider,{value:je,children:e.jsx(be,z({as:p,className:pe(s.root,b),ref:x,role:p===E?null:"rowgroup",ownerState:m},j))})}),Re=ve;var C={},Ce=H;Object.defineProperty(C,"__esModule",{value:!0});var O=C.default=void 0,ye=Ce(N()),Te=e,_e=(0,ye.default)((0,Te.jsx)("path",{d:"m22.7 19-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4z"}),"Build");O=C.default=_e;var y={},ke=H;Object.defineProperty(y,"__esModule",{value:!0});var R=y.default=void 0,Le=ke(N()),Se=e,Ie=(0,Le.default)((0,Se.jsx)("path",{d:"M5 20h14v-2H5v2zM19 9h-4V3H9v6H5l7 7 7-7z"}),"Download");R=y.default=Ie;function Pe(){var _,k,L,S,I,P,U,B,D,A,F;const[i,n]=d.useState(!1),[x,u]=d.useState(!1),[b,p]=d.useState(!1),[j,m]=d.useState(null),[s,q]=d.useState({});d.useEffect(()=>{T()},[]);const T=()=>{n(!0);const t=new URL(`${g}/blocking/report/activation`);fetch(t).then(a=>a.json()).then(a=>{q(a)}).finally(()=>n(!1))},W=()=>{u(!0);const t=new URL(`${g}/blocking/report`);fetch(t).then(a=>a.json()).then(()=>{T()}).finally(()=>u(!1))},G=()=>{p(!0);const t=new URL(`${g}/blocking/report/activation/download`);let a="";fetch(t).then(l=>{const c=l.headers.get("Content-Disposition");return c&&(a=c.split(";")[1].split("=")[1].replaceAll('"',"")),l.blob()}).then(l=>URL.createObjectURL(l)).then(l=>{Object.assign(document.createElement("a"),{href:l,download:a}).click()}).finally(()=>{p(!1)})},Q=(t,a)=>{n(!0),m(a);const l=new URL(`${g}/blocking/report/customers`),c={name:t};l.search=new URLSearchParams(c).toString();let h="";fetch(l).then(r=>{const $=r.headers.get("Content-Disposition");return $&&(h=$.split(";")[1].split("=")[1].replaceAll('"',"")),r.blob()}).then(r=>URL.createObjectURL(r)).then(r=>{Object.assign(document.createElement("a"),{href:r,download:h}).click()}).finally(()=>{m(null),n(!1)})},V=()=>{W()},J=()=>{G()},K=(t,a)=>{Q(t,a)};return e.jsx(Z,{sx:{mt:4,mb:4},children:e.jsx(M,{sx:{width:"100%",position:"relative"},children:e.jsxs(ee,{variant:"outlined",children:[e.jsxs(se,{children:[e.jsx(te,{variant:"h6",noWrap:!0,component:"div",color:"primary",sx:{flexGrow:1,display:{xs:"none",sm:"block"}},children:"Consolidado"}),e.jsxs(M,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(v,{size:"small",color:"primary",startIcon:e.jsx(O,{}),onClick:()=>V(),disabled:((_=s==null?void 0:s.activationReport)==null?void 0:_.length)!==0,loading:x,children:"Generar"}),e.jsx(v,{size:"small",color:"primary",startIcon:e.jsx(R,{}),onClick:()=>J(),disabled:i||((k=s==null?void 0:s.activationReport)==null?void 0:k.length)===0,loading:b,children:"Decargar"})]})]}),i&&e.jsx(ae,{sx:{position:"absolute",top:"0",left:0,right:0,borderRadius:4,zIndex:3}}),e.jsx(le,{sx:{maxHeight:637},children:e.jsxs(ne,{stickyHeader:!0,size:"small",children:[e.jsx(ie,{children:e.jsxs(f,{children:[e.jsx(o,{children:"Cliente"}),e.jsx(o,{align:"right",children:"Facturables"}),e.jsx(o,{align:"right",children:"No Facturables"}),e.jsx(o,{align:"right",children:"APS"}),e.jsx(o,{align:"right",children:"APQ"}),e.jsx(o,{align:"right",children:"Acciones"})]})}),e.jsx(re,{children:(L=s==null?void 0:s.activationReport)==null?void 0:L.map((t,a)=>{var l,c,h,r;return e.jsxs(f,{children:[e.jsx(o,{component:"th",scope:"row",children:t==null?void 0:t.customerName}),e.jsx(o,{align:"right",children:(l=t==null?void 0:t._sum)==null?void 0:l.billable}),e.jsx(o,{align:"right",children:(c=t==null?void 0:t._sum)==null?void 0:c.nonBillable}),e.jsx(o,{align:"right",children:(h=t==null?void 0:t._sum)==null?void 0:h.billableWeekly}),e.jsx(o,{align:"right",children:(r=t==null?void 0:t._sum)==null?void 0:r.billableBiweekly}),e.jsx(o,{children:e.jsx(ce,{direction:"row",spacing:1,justifyContent:"flex-end",children:e.jsx(v,{size:"small",color:"primary",startIcon:e.jsx(R,{}),onClick:()=>K(t==null?void 0:t.customerName,a),disabled:i,loading:j===a,children:"Reporte"})})})]},t==null?void 0:t.customerName)})}),e.jsxs(Re,{sx:{left:0,bottom:0,zIndex:2,position:"sticky"},children:[e.jsx(f,{sx:{backgroundColor:"white"},children:e.jsx(o,{colSpan:6,sx:{padding:0}})}),e.jsxs(f,{sx:{backgroundColor:"white"},children:[e.jsx(o,{variant:"head",children:"Totales"}),e.jsx(o,{align:"right",variant:"head",children:(I=(S=s==null?void 0:s.activationReportTotals)==null?void 0:S._sum)==null?void 0:I.billable}),e.jsx(o,{align:"right",variant:"head",children:(U=(P=s==null?void 0:s.activationReportTotals)==null?void 0:P._sum)==null?void 0:U.nonBillable}),e.jsx(o,{align:"right",variant:"head",children:(D=(B=s==null?void 0:s.activationReportTotals)==null?void 0:B._sum)==null?void 0:D.billableWeekly}),e.jsx(o,{align:"right",variant:"head",children:(F=(A=s==null?void 0:s.activationReportTotals)==null?void 0:A._sum)==null?void 0:F.billableBiweekly}),e.jsx(o,{})]})]})]})})]})})})}function qe(){return e.jsx(me,{title:"Consolidado",children:e.jsx(Pe,{})})}export{qe as default};
